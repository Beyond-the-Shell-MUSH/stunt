From ecf3f86170b836634d5c13b23ccbc69d4427718f Mon Sep 17 00:00:00 2001
From: Steve Wainstead <wainstead@gmail.com>
Date: Sun, 28 Jun 2009 23:26:20 +0000
Subject: [PATCH 021/223] Fixed calls to getsockname with casts

---
 server/net_bsd_tcp.c  |    4 ++--
 server/net_mp_selct.c |    2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/server/net_bsd_tcp.c b/server/net_bsd_tcp.c
index 8390894..92bd41f 100644
--- a/server/net_bsd_tcp.c
+++ b/server/net_bsd_tcp.c
@@ -108,7 +108,7 @@ proto_make_listener(Var desc, int *fd, Var * canon, const char **name)
     if (port == 0) {
 	size_t length = sizeof(address);
 
-	if (getsockname(s, (struct sockaddr *) &address, &length) < 0) {
+	if (getsockname(s, (struct sockaddr *) &address, (socklen_t *) &length) < 0) {
 	    log_perror("Discovering local port number");
 	    close(s);
 	    return E_QUOTA;
@@ -145,7 +145,7 @@ proto_accept_connection(int listener_fd, int *read_fd, int *write_fd,
     if (!s)
 	s = new_stream(100);
 
-    fd = accept(listener_fd, (struct sockaddr *) &address, &addr_length);
+    fd = accept(listener_fd, (struct sockaddr *) &address, (socklen_t *) &addr_length);
     if (fd < 0) {
 	if (errno == EMFILE)
 	    return PA_FULL;
diff --git a/server/net_mp_selct.c b/server/net_mp_selct.c
index 9ee7e2b..e171a43 100644
--- a/server/net_mp_selct.c
+++ b/server/net_mp_selct.c
@@ -61,7 +61,7 @@ mplex_wait(unsigned timeout)
     tv.tv_sec = timeout;
     tv.tv_usec = 0;
 
-    n = select(max_descriptor + 1, (void *) &input, (void *) &output, 0, &tv);
+    n = select(max_descriptor + 1, (fd_set *) &input, (fd_set *) &output, 0, &tv);
 
     if (n < 0) {
 	if (errno != EINTR)
-- 
1.7.9.5

