From 5d16402dc48c8ec599c2d3ee1a25a73e8bece3ba Mon Sep 17 00:00:00 2001
From: Steve Wainstead <wainstead@gmail.com>
Date: Wed, 15 Jun 2011 01:27:38 +0000
Subject: [PATCH 153/223] Renaming this to waverous-tester.exp, and giving it
 the GPL licensing.

---
 server/tools/waverous-tester.exp |   47 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 47 insertions(+)
 create mode 100755 server/tools/waverous-tester.exp

diff --git a/server/tools/waverous-tester.exp b/server/tools/waverous-tester.exp
new file mode 100755
index 0000000..ff90454
--- /dev/null
+++ b/server/tools/waverous-tester.exp
@@ -0,0 +1,47 @@
+#!/usr/bin/expect
+
+# Copyright 2010, 2011 Steve Wainstead. This script is part of the
+# Waverous Lambdamoo server distribution, but is not compiled into the
+# server itself; as such it's a standalone program to interact with
+# the server. It is licensed under the GNU Public License.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of version 2 of the GNU General Public License as
+# published by the Free Software Foundation.  This program is
+# distributed in the hope that it will be useful, but WITHOUT ANY
+# WARRANTY; without even the implied warranty of MERCHANTABILITY or
+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
+# License for more details.  http://www.gnu.org/
+
+
+# Start up the server, login, run commands, shutdown
+
+puts "MOO test starting"
+
+#cd "~swain/Sites/projects/lambdamoo/build"
+
+
+spawn ./restart.sh LambdaCore-12Apr99
+puts "sleeping for three seconds"
+sleep 3
+spawn /usr/local/bin/tf localhost 7777
+sleep 2
+expect {
+    "Connection refused" { 
+        send "/quit\r"
+        puts "Server startup failed!"
+        exit 1
+    }
+    "Type 'connect wizard' to log in." {
+        send "connect wizard\r"        
+    }
+}
+
+expect "The First Room" { puts "Success." }
+
+sleep 2
+send "@shutdown in 0 \"ending test\"\r"
+expect "Do you really want to shut down the server"
+send "yes\r"
+expect eof
+puts "Test completed successfully."
-- 
1.7.9.5

